infrastructure:
  server: helios
  slurm:
    cpus_per_gpu: 12
    gres: ???
    job-name: test
    mem_per_gpu: 90G
    nodes: 1
    partition: plgrid-gpu-gh200
    time: "2-00:00:00"

  script:
    - "module load ML-bundle/25.04"
    - "PROJECT_HOME_PATH=$PLG_GROUPS_STORAGE/plggllmeffi/projected_compression"
    - |
      VENV_PATH=$PROJECT_HOME_PATH/pc_venv
      export HF_HOME=$PROJECT_HOME_PATH/hf_cache

      # Check if venv exists
      if [ ! -d "$VENV_PATH" ]; then
        echo 'Virtual environment not found. Creating...'
        python3 -m venv "$VENV_PATH"
        pip install --upgrade pip
      fi 
      source "$VENV_PATH/bin/activate"
      pip install --upgrade -r requirements.txt

trainer:
  checkpoint:
    save:
      path: "/net/storage/pr3/plgrid/plggllmeffi/projected_compression"

cluster_switch:
  train_path_c4: "/net/scratch/hscra/plgrid/plgmaciejpioro/c4/train"
  eval_path_c4: "/net/scratch/hscra/plgrid/plgmaciejpioro/c4/validation"
  train_path_fineweb: "/net/scratch/hscra/plgrid/plgmaciejpioro/fineweb-edu/train/train"
  eval_path_fineweb: "/net/scratch/hscra/plgrid/plgmaciejpioro/fineweb-edu/train/train"
